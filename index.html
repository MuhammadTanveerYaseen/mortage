<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday My Future Wife - Jan-e-Jahan Areej Fatima</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        const { jsPDF } = window.jspdf;
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #0f0f1a;
            overflow-x: hidden;
            color: #fff;
        }
        .handwritten {
            font-family: 'Dancing Script', cursive;
        }
        .bg-romantic {
            background: linear-gradient(135deg, #0f0524 0%, #3a154f 25%, #892584 50%, #d63e72 75%, #ff7b93 100%);
        }
        .particle {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            pointer-events: none;
        }
        .flower {
            position: absolute;
            background-size: contain;
            background-repeat: no-repeat;
            pointer-events: none;
            opacity: 0.7;
            animation: float 6s ease-in-out infinite;
        }
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg) scale(1); }
            25% { transform: translateY(-10px) rotate(2deg) scale(1.05); }
            50% { transform: translateY(-20px) rotate(5deg) scale(1.1); }
            75% { transform: translateY(-10px) rotate(2deg) scale(1.05); }
            100% { transform: translateY(0) rotate(0deg) scale(1); }
        }
        .rose-petal {
            position: absolute;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="%23ff69b4" d="M50,15 C60,0 80,5 85,20 C90,35 70,50 50,65 C30,50 10,35 15,20 C20,5 40,0 50,15 Z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            opacity: 0.8;
            animation: petal-fall 8s linear infinite;
        }
        .kiss {
            animation-name: petal-fall-kiss;
            z-index: 1;
        }
        @keyframes petal-fall {
            0% { transform: translate(0, -10vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            100% { transform: translate(calc(50vw - 50%), 100vh) rotate(360deg); opacity: 0; }
        }
        @keyframes petal-fall-kiss {
            0% { transform: translate(0, -10vh) rotate(0deg) scale(0.5); opacity: 0; }
            10% { opacity: 1; transform: scale(1.2); }
            50% { transform: scale(1.5); }
            100% { transform: translate(calc(50vw - 50%), 100vh) rotate(360deg) scale(0.8); opacity: 0; }
        }
        .message-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        .glow {
            animation: glow 2s ease-in-out infinite alternate;
        }
        @keyframes glow {
            from { box-shadow: 0 0 10px -10px #f687b3; }
            to { box-shadow: 0 0 20px 5px #f687b3; }
        }
        .btn-romantic {
            background: linear-gradient(45deg, #9a1f6a, #4a1e6a);
            transition: all 0.3s ease;
        }
        .btn-romantic:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(154, 31, 106, 0.3);
        }
        .hearts {
            position: absolute;
            width: 20px;
            height: 20px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ff0000"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>') no-repeat center center;
            pointer-events: none;
            opacity: 0;
        }
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
        }
    </style>
</head>
<body class="bg-romantic min-h-screen flex flex-col items-center justify-center relative overflow-hidden">
    <!-- Background elements -->
    <div id="particles"></div>
    <div id="flowers"></div>
    <div id="hearts-container"></div>
    
    <!-- Romantic Verse -->
    <div class="absolute top-4 left-4 z-50 text-pink-200 italic handwritten text-sm md:text-base">
        "From my first glance, I measured eternity<br>
        Through your eyes, I found infinity<br>
        Happy Birthday to my heart's compass"
    </div>

    <!-- Audio Toggle -->
    <div class="absolute top-4 right-4 z-50">
        <button id="musicToggle" class="bg-pink-600 hover:bg-pink-700 text-white rounded-full p-3 shadow-lg">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15.536a5 5 0 001.414 1.414m2.828-9.9a9 9 0 011.414 1.414" />
            </svg>
        </button>
        <audio id="bgMusic" loop>
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3" type="audio/mpeg">
            <!-- Backup romantic flute music -->
            <source src="https://assets.mixkit.co/music/preview/mixkit-romantic-flute-623.mp3" type="audio/mpeg">
        </audio>
    </div>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-12 z-10 max-w-4xl">
        <div id="stepContainer" class="flex flex-col items-center">
            <!-- Step 1 will be inserted here -->
        </div>
    </div>

    <!-- Final Celebration (hidden initially) -->
    <div id="finalCelebration" class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 hidden">
        <div class="text-center p-8 max-w-2xl">
            <h1 class="handwritten text-5xl md:text-7xl text-pink-400 mb-6 glow">Happy Birthday My Eternal Love Areej Fatima</h1>
            <div id="finalSparkles" class="my-8"></div>
            <p class="text-xl mb-8 handwritten">"My soul recognizes yours like the moon recognizes its ocean - drawn in inevitable tide. On this day when the universe first received your light, I celebrate the miracle of your existence. May Allah bless every step with grace, every breath with joy, and every moment with love as infinite as my devotion to you - today and for all the beautiful tomorrows we'll share together."</p>
            <button id="downloadBtn" class="btn-romantic text-white font-bold py-3 px-6 rounded-full text-lg mb-4">
                Download Our Love Letter
            </button>
            <button id="restartBtn" class="bg-white text-pink-600 font-bold py-3 px-6 rounded-full text-lg">
                Relive Our Story
            </button>
        </div>
    </div>

    <script>
        // Gift icons mapping
        function getGiftIcon(giftType) {
            const icons = {
                ring: 'üíç',
                memory: 'üì∑',
                nameplate: 'üè∑Ô∏è',
                hijab: 'üßï',
                heart: '‚ù§Ô∏è',
                book: 'üìñ',
                smile: 'üòä',
                eyes: 'üëÄ',
                shield: 'üõ°Ô∏è',
                prayer: 'üïå',
                music: 'üéµ',
                hands: 'ü§≤',
                home: 'üè†',
                lamp: 'üí°',
                clock: '‚è≥',
                mosque: 'üïå',
                food: 'üç≤',
                anchor: '‚öì',
                scroll: 'üìú',
                eternity: '‚àû'
            };
            return icons[giftType] || 'üéÅ';
        }

        // Data for all 20 steps
        const steps = [
            {
                title: "My Soul's Beloved",
                message: "Every atom of my being trembles with love for you. You are the sweetest poetry my heart could ever compose.",
                gift: "heart",
                bgEffect: "stars"
            },
            {
                title: "Your Gaze",
                message: "When your eyes meet mine, time stops. I see eternity in their depth, and my soul finds its refuge.",
                gift: "eyes",
                bgEffect: "sparkles"
            },
            {
                title: "Secret Desires",
                message: "I long for the night when I can whisper how beautiful you are as I trace the curves Allah has blessed you with.",
                gift: "eternity",
                bgEffect: "glow"
            },
            {
                title: "Your Scent",
                message: "The fragrance of your skin intoxicates me more than any perfume. One whiff and I'm drunk with desire.",
                gift: "flowers",
                bgEffect: "petals"
            },
            {
                title: "Your Lips",
                message: "That first halal kiss I will plant on your lips - how I dream of its sweetness, soft as rose petals yet burning with passion.",
                gift: "kiss",
                bgEffect: "hearts"
            },
            {
                title: "Your Touch",
                message: "Even the most innocent brush of your finger against mine sends electric currents through my body.",
                gift: "hands",
                bgEffect: "stars"
            },
            {
                title: "Your Voice",
                message: "The melody of your voice lingers in my ear like the sweetest Quran recitation - I could listen to it forever.",
                gift: "music",
                bgEffect: "glow"
            },
            {
                title: "Your Modesty",
                message: "The way your hijab drapes around your face only increases my desire to unveil your beauty in halal ways.",
                gift: "hijab",
                bgEffect: "sparkles"
            },
            {
                title: "Your Curves",
                message: "The shape of your body under that abaya teases my imagination - what blessed forms Allah has created just for my eyes.",
                gift: "forms",
                bgEffect: "petals"
            },
            {
                title: "Waiting for You",
                message: "Every night I lie awake imagining your warmth beside me, your breath on my skin - the halal intimacy we'll share.",
                gift: "bed",
                bgEffect: "hearts"
            },
            {
                title: "Intimate Moments",
                message: "I dream of the night I can finally explore every inch of your body with my lips, worshipping you like the treasure you are.",
                gift: "lips",
                bgEffect: "stars"
            },
            {
                title: "Your Beauty",
                message: "No sunrise compares to your radiance. You're Allah's masterpiece painted just for my eyes to adore.",
                gift: "art",
                bgEffect: "glow"
            },
            {
                title: "Your Smile",
                message: "When you smile, angels pause their tasbeeh. It's my personal glimpse of Jannah's joy.",
                gift: "smile",
                bgEffect: "sparkles"
            },
            {
                title: "Your Strength",
                message: "The strength in your delicate frame - carrying wisdom, faith and passion - makes me weak with admiration.",
                gift: "strength",
                bgEffect: "petals"
            },
            {
                title: "Our Future Nights",
                message: "I dream of lazy mornings tracing arabesques on your bare skin as sunlight filters through our bedroom curtains.",
                gift: "mornings",
                bgEffect: "hearts"
            },
            {
                title: "Your Passion",
                message: "The fire in your eyes when you speak of your dreams makes me burn with desire to support and cherish you.",
                gift: "fire",
                bgEffect: "stars"
            },
            {
                title: "Your Intelligence",
                message: "Nothing is sexier than your brilliant mind - except perhaps when you let me see the playful, passionate woman beneath.",
                gift: "mind",
                bgEffect: "glow"
            },
            {
                title: "Your Laughter",
                message: "Your laughter is my favorite sound in this world, sweeter than birdsong at fajr, more uplifting than the adhan.",
                gift: "joy",
                bgEffect: "sparkles"
            },
            {
                title: "Your Body",
                message: "The dip of your waist, the curve of your hips - Allah crafted you perfectly to fit against me.",
                gift: "body",
                bgEffect: "petals"
            },
            {
                title: "Our Wedding Night",
                message: "How I yearn for that blessed evening when I can finally know you completely - body, mind and soul.",
                gift: "wedding",
                bgEffect: "hearts"
            },
            {
                title: "Your Secrets",
                message: "What hidden desires lie beneath your modest exterior? I vow to uncover them all halal-ly and worship every one.",
                gift: "desire",
                bgEffect: "stars"
            },
            {
                title: "Your Skin",
                message: "The thought of your soft skin pressed against mine keeps me awake with longing for our halal union.",
                gift: "touch",
                bgEffect: "glow"
            },
            {
                title: "Your Femininity",
                message: "The way you move - with such grace and power - makes my pulse race every time.",
                gift: "grace",
                bgEffect: "sparkles"
            },
            {
                title: "Bedroom Whispers",
                message: "I imagine the sweet nothings we'll exchange in our most private moments - promises, prayers and praises.",
                gift: "whispers",
                bgEffect: "petals"
            },
            {
                title: "Your Mystery",
                message: "You're like a magnificent palace - each discovery of your depths more breathtaking than the last.",
                gift: "palace",
                bgEffect: "hearts"
            },
            {
                title: "Our Bed",
                message: "Our future bed awaits - where we'll share laughter, stories, passion and worship under Allah's watch.",
                gift: "future",
                bgEffect: "stars"
            },
            {
                title: "Your Surrender",
                message: "The thought of you willingly giving yourself to me halal-ly makes my heart pound with awe and desire.",
                gift: "trust",
                bgEffect: "glow"
            },
            {
                title: "Morning After",
                message: "I dream of waking beside you - messy hair, sleep-soft eyes, and the contentment of being truly, halal-ly one.",
                gift: "morning",
                bgEffect: "sparkles"
            },
            {
                title: "Your Modest Charms",
                message: "The way your fingers peek from your sleeves, the accidental glimpse of ankle - you tease without trying.",
                gift: "tease",
                bgEffect: "petals"
            },
            {
                title: "Private Dances",
                message: "I long for the halal moments when you'll dance only for me, unveiled and unashamed in our sacred space.",
                gift: "dance",
                bgEffect: "hearts"
            },
            {
                title: "Your Kisses",
                message: "I imagine your kisses - first shy, then growing bolder as our love deepens over years together.",
                gift: "love",
                bgEffect: "stars"
            },
            {
                title: "Your Warmth",
                message: "Winter nights with you pressed close to share body heat - this simple joy I anticipate most.",
                gift: "warmth",
                bgEffect: "glow"
            },
            {
                title: "Sacred Intimacy",
                message: "Making love with you will be my greatest ibadah - worship through pleasure and connection.",
                gift: "worship",
                bgEffect: "sparkles"
            },
            {
                title: "Pregnancy",
                message: "Seeing your body change as it carries our child - you'll be most beautiful glowing with motherhood.",
                gift: "mother",
                bgEffect: "petals"
            },
            {
                title: "Growing Old",
                message: "Your silver hair will be just as beautiful as your dark locks today - I'll adore you at every age.",
                gift: "age",
                bgEffect: "hearts"
            },
            {
                title: "Jannah Together",
                message: "Our earthly passion is but a shadow of the bliss we'll share eternally in Paradise inshaAllah.",
                gift: "jannah",
                bgEffect: "stars"
            },
            {
                title: "My Eternal Vow",
                message: "I surrender my heart to you completely, my beloved. With every beat, it whispers your name. I pledge not just this life but all my existences to you - in every universe, in every dimension, my soul will always find yours. You are the love that transcends time, the miracle that defies logic. Let our love story become legend, whispered by the stars long after we're gone. I choose you today, tomorrow, and for all eternity - not just as my wife but as my destiny, my answered prayer, the very reason Allah breathed life into me. You are my beginning, my forever, and my perfect ending.",
                gift: "eternity",
                bgEffect: "glow"
            },
            {
                title: "Our Sacred Bond",
                message: "This love we share is written in the stars, ordained by the Divine. When our hands finally touch on our walimah, electricity will course through every vein. That first halal embrace will set my soul ablaze - the years of longing finally satisfied yet multiplied a thousandfold. I dream of the mornings when I'll wake to your scent on my skin, your breath mingling with mine, our hearts beating in perfect synchrony. Every inch of your being fascinates me - the curve of your smile, the fire in your eyes, the softness of your skin I've yet to explore. You are my greatest adventure, my most treasured secret, and my most profound worship.",
                gift: "soul",
                bgEffect: "hearts"
            },
            {
                title: "Beyond Time",
                message: "If I could rewrite history, I'd place our love at the center of every civilization. Paint us in hieroglyphics, carve our story in stone, weave our names into ancient tapestries. Let the universe remember how completely I adored you. When shaytan tried to divide us, our sabr became legendary. When distance tested us, our love grew ferocious. This isn't just romance - it's revolution, quiet yet earth-shattering. I promise to love you with the intensity of a thousand supernovas yet with the tenderness of dawn's first light. You deserve passion that shakes the heavens and devotion that outlasts the stars.",
                gift: "cosmos",
                bgEffect: "stars"
            },
            {
                title: "Our Last Dance",
                message: "When time has silvered our hair and softened our steps, I'll still reach for you in the dark with the same reverence as our first halal touch. Your wrinkles will be the sacred map of our adventures, each line a love letter written by time itself. Even when our hands tremble, they'll find each other with the same magnetic pull as when we were young. And when the angel of death comes - whether for me or for you - know this with certainty: I will be waiting at the gates of Jannah, not as an old man but as your eternal lover, radiant with youth, arms outstretched to receive you. There, beneath Allah's merciful gaze, our souls will dance again - not with the slow steps of age but with the boundless energy of eternal love. For this life is just our first meeting, habibti. The real romance begins when we meet again in gardens beneath which rivers flow.",
                gift: "infinity",
                bgEffect: "glow"
            }
        ];

        // DOM elements
        const stepContainer = document.getElementById('stepContainer');
        const particlesContainer = document.getElementById('particles');
        const flowersContainer = document.getElementById('flowers');
        const heartsContainer = document.getElementById('hearts-container');
        const finalCelebration = document.getElementById('finalCelebration');
        const finalSparkles = document.getElementById('finalSparkles');
        const musicToggle = document.getElementById('musicToggle');
        const bgMusic = document.getElementById('bgMusic');
        const downloadBtn = document.getElementById('downloadBtn');
        const restartBtn = document.getElementById('restartBtn');

        // Current step index
        let currentStep = 0;

        // Initialize the app
        function init() {
            createBackgroundElements();
            showStep(currentStep);
            setupEventListeners();
        }

        // Create floating background elements
        function createBackgroundElements() {
            // Create rose petals and kisses
            for (let i = 0; i < 100; i++) { // Increased to 100 petals for more romance
                // Rose petals
                const petal = document.createElement('div');
                petal.className = 'rose-petal';
                petal.style.width = `${Math.random() * 50 + 30}px`; // Increased size range
                petal.style.height = petal.style.width;
                petal.style.left = `${Math.random() * 100}vw`;
                petal.style.top = `-10vh`;
                petal.style.animationDelay = `${Math.random() * 5}s`;
                document.body.appendChild(petal);
                
                // Kisses (added new elements)
                if (i % 2 === 0) { // Create kisses for half the iterations
                    const kiss = document.createElement('div');
                    kiss.className = 'rose-petal kiss';
                    kiss.style.width = `${Math.random() * 60 + 30}px`; // Larger size range
                    kiss.style.height = kiss.style.width;
                    kiss.style.left = `${Math.random() * 100}vw`;
                    kiss.style.top = `-10vh`;
                    kiss.style.animationDelay = `${Math.random() * 5 + 2}s`;
                    kiss.style.backgroundImage = 'url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 24 24\' fill=\'%23ff69b4\'><path d=\'M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\'/></svg>")';
                    document.body.appendChild(kiss);
                }
            }
            
            // Create particles
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.width = `${Math.random() * 5 + 2}px`;
                particle.style.height = particle.style.width;
                particle.style.left = `${Math.random() * 100}vw`;
                particle.style.top = `${Math.random() * 100}vh`;
                particle.style.opacity = Math.random() * 0.5 + 0.1;
                particle.style.animation = `float ${Math.random() * 10 + 5}s linear infinite`;
                particlesContainer.appendChild(particle);
            }

            // Create flowers
            const flowerColors = ['üåπ', 'üåπ', 'üåπ', 'üå∏', 'üå∫']; // More roses
            for (let i = 0; i < 15; i++) {
                const flower = document.createElement('div');
                flower.className = 'flower';
                flower.style.fontSize = `${Math.random() * 20 + 10}px`;
                flower.style.left = `${Math.random() * 100}vw`;
                flower.style.top = `${Math.random() * 100}vh`;
                flower.style.animationDelay = `${Math.random() * 5}s`;
                flower.textContent = flowerColors[Math.floor(Math.random() * flowerColors.length)];
                flowersContainer.appendChild(flower);
            }
        }

        // Show a specific step
        function showStep(stepIndex) {
            if (stepIndex >= steps.length) {
                showFinalCelebration();
                return;
            }

            const step = steps[stepIndex];
            
            // Clear previous step
            stepContainer.innerHTML = '';
            
            // Create step elements
            const stepElement = document.createElement('div');
            stepElement.className = 'message-card rounded-2xl p-8 w-full text-center transform transition-all duration-500';
            
            // Create title
            const titleElement = document.createElement('h2');
            titleElement.className = 'handwritten text-4xl md:text-5xl text-pink-300 mb-6';
            titleElement.textContent = step.title;
            
            // Create message
            const messageElement = document.createElement('p');
            messageElement.className = 'text-lg md:text-xl mb-8 leading-relaxed';
            messageElement.textContent = step.message;
            
            // Create gift box
            const giftContainer = document.createElement('div');
            giftContainer.className = 'relative my-8 flex justify-center';
            
            const giftBox = document.createElement('div');
            giftBox.className = 'gift-box relative w-24 h-24 md:w-32 md:h-32 cursor-pointer';
            giftBox.innerHTML = `
                <div class="absolute inset-0 bg-pink-500 rounded-lg flex items-center justify-center text-4xl md:text-5xl">
                    üéÅ
                </div>
                <div class="gift-content absolute inset-0 bg-purple-500 rounded-lg flex flex-col items-center justify-center text-white">
                    <span class="text-4xl md:text-5xl">${getGiftIcon(step.gift)}</span>
                    <span class="text-xs mt-2">Gift ${stepIndex + 1}</span>
                </div>
            `;
            
            // Create next button
            const nextButton = document.createElement('button');
            nextButton.className = 'btn-romantic text-white font-bold py-3 px-8 rounded-full text-lg mt-6';
            nextButton.textContent = stepIndex === steps.length - 1 ? 'Final Promise' : 'Continue Our Journey';
            
            // Add elements to step
            giftContainer.appendChild(giftBox);
            stepElement.appendChild(titleElement);
            stepElement.appendChild(messageElement);
            stepElement.appendChild(giftContainer);
            stepElement.appendChild(nextButton);
            stepContainer.appendChild(stepElement);
            
            nextButton.addEventListener('click', function() {
                currentStep++;
                showStep(currentStep);
            });
            
            // Trigger background effect
            triggerBackgroundEffect(step.bgEffect);
        }

        // Show final celebration
        function showFinalCelebration() {
            finalCelebration.classList.remove('hidden');
            createConfetti(100);
            playCelebrationSound();
        }

        // Create hearts animation
        function createHearts(count) {
            for (let i = 0; i < count; i++) {
                const heart = document.createElement('div');
                heart.className = 'hearts';
                heart.style.left = `${Math.random() * 100}%`;
                heart.style.top = `${Math.random() * 100}%`;
                heart.style.width = `${Math.random() * 30 + 10}px`;
                heart.style.height = heart.style.width;
                heart.style.animation = `float ${Math.random() * 3 + 2}s linear forwards`;
                heart.style.opacity = '1';
                
                heartsContainer.appendChild(heart);
                
                // Remove heart after animation
                setTimeout(() => {
                    heart.remove();
                }, 3000);
            }
        }

        // Create confetti for final celebration
        function createConfetti(count) {
            finalSparkles.innerHTML = '';
            const colors = ['#f00', '#0f0', '#00f', '#ff0', '#f0f', '#0ff'];
            
            for (let i = 0; i < count; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.top = `-10px`;
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                confetti.style.width = `${Math.random() * 10 + 5}px`;
                confetti.style.height = `${Math.random() * 10 + 5}px`;
                
                finalSparkles.appendChild(confetti);
                
                // Animate confetti
                setTimeout(() => {
                    confetti.style.opacity = '1';
                    confetti.style.transform = `translateY(${window.innerHeight}px) rotate(${Math.random() * 360}deg)`;
                    confetti.style.transition = `all ${Math.random() * 3 + 2}s linear`;
                    
                    // Remove confetti after animation
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }, i * 100);
            }
        }

        // Trigger background effects based on step
        function triggerBackgroundEffect(effect) {
            switch(effect) {
                case 'stars':
                    createStars();
                    break;
                case 'petals':
                    createPetals();
                    break;
                case 'glow':
                    document.body.classList.add('glow');
                    setTimeout(() => document.body.classList.remove('glow'), 2000);
                    break;
                case 'sparkles':
                    createSparkles();
                    break;
                case 'hearts':
                    createHearts(15);
                    break;
            }
        }

        // Create stars effect
        function createStars() {
            const stars = document.createElement('div');
            stars.className = 'absolute inset-0 overflow-hidden';
            
            for (let i = 0; i < 30; i++) {
                const star = document.createElement('div');
                star.className = 'absolute bg-white rounded-full';
                star.style.width = `${Math.random() * 3 + 1}px`;
                star.style.height = star.style.width;
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                star.style.opacity = '0';
                star.style.animation = `twinkle ${Math.random() * 3 + 2}s infinite alternate`;
                
                stars.appendChild(star);
            }
            
            document.body.appendChild(stars);
            
            // Remove after animation
            setTimeout(() => {
                stars.remove();
            }, 3000);
        }

        // Create petals effect
        function createPetals() {
            const petals = document.createElement('div');
            petals.className = 'absolute inset-0 overflow-hidden';
            
            for (let i = 0; i < 20; i++) {
                const petal = document.createElement('div');
                petal.className = 'absolute';
                petal.style.fontSize = `${Math.random() * 20 + 10}px`;
                petal.style.left = `${Math.random() * 100}%`;
                petal.style.top = `-30px`;
                petal.textContent = 'üå∏';
                petal.style.opacity = '0';
                petal.style.animation = `fall ${Math.random() * 5 + 3}s linear forwards`;
                
                petals.appendChild(petal);
            }
            
            document.body.appendChild(petals);
            
            // Remove after animation
            setTimeout(() => {
                petals.remove();
            }, 5000);
        }

        // Create sparkles effect
        function createSparkles() {
            const sparkles = document.createElement('div');
            sparkles.className = 'absolute inset-0 overflow-hidden';
            
            for (let i = 0; i < 20; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'absolute bg-yellow-200 rounded-full';
                sparkle.style.width = `${Math.random() * 5 + 2}px`;
                sparkle.style.height = sparkle.style.width;
                sparkle.style.left = `${Math.random() * 100}%`;
                sparkle.style.top = `${Math.random() * 100}%`;
                sparkle.style.opacity = '0';
                sparkle.style.animation = `sparkle ${Math.random() * 1 + 0.5}s infinite alternate`;
                
                sparkles.appendChild(sparkle);
            }
            
            document.body.appendChild(sparkles);
            
            // Remove after animation
            setTimeout(() => {
                sparkles.remove();
            }, 2000);
        }

        // Play sparkle sound
        function playSparkleSound() {
            // In a real app, you would play an actual sound file here
            console.log("Sparkle sound played");
        }

        // Play celebration sound
        function playCelebrationSound() {
            // In a real app, you would play an actual sound file here
            console.log("Celebration sound played");
        }

        // Setup event listeners
        function setupEventListeners() {
            // Music toggle
            musicToggle.addEventListener('click', function() {
                if (bgMusic.paused) {
                    bgMusic.play();
                    musicToggle.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clip-rule="evenodd" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" /></svg>';
                } else {
                    bgMusic.pause();
                    musicToggle.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15.536a5 5 0 001.414 1.414m2.828-9.9a9 9 0 011.414 1.414" /></svg>';
                }
            });

            // Download button
            downloadBtn.addEventListener('click', function() {
                // Create a PDF of all messages
                const doc = new jsPDF();
                doc.setFontSize(22);
                doc.text('Our Love Story', 105, 20, null, null, 'center');
                doc.setFontSize(16);
                
                let y = 40;
                steps.forEach((step, index) => {
                    if (y > 280) {
                        doc.addPage();
                        y = 20;
                    }
                    doc.setFontSize(18);
                    doc.text(`${index + 1}. ${step.title}`, 20, y);
                    y += 10;
                    doc.setFontSize(12);
                    const splitText = doc.splitTextToSize(step.message, 170);
                    doc.text(splitText, 20, y + 5);
                    y += splitText.length * 7 + 15;
                });
                
                doc.save('Our_Love_Story.pdf');
            });

            // Restart button
            restartBtn.addEventListener('click', function() {
                currentStep = 0;
                finalCelebration.classList.add('hidden');
                showStep(currentStep);
            });
        }

        // Add CSS animations dynamically
        const style = document.createElement('style');
        style.textContent = `
            @keyframes twinkle {
                0% { opacity: 0; }
                100% { opacity: 1; }
            }
            @keyframes fall {
                0% { transform: translateY(0) rotate(0deg); opacity: 0; }
                10% { opacity: 1; }
                100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
            }
            @keyframes sparkle {
                0% { opacity: 0; transform: scale(0.5); }
                100% { opacity: 1; transform: scale(1.5); }
            }
        `;
        document.head.appendChild(style);

        // Initialize the app
        window.addEventListener('load', init);
    </script>
</body>
</html>
